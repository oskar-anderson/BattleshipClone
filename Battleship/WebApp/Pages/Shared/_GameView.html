<html lang="en">
<head>
    <title>Battleship</title>
    <link rel="stylesheet" href="~/css/site.css" />
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet"> 
</head>
<style>

</style>
<body>
    <div>
        <div id="gameData">@JSON.stringify(Model);</div>
        <div id="gameBoard">@Model.BoardSerializationFriendly</div>
    </div>

    <h2>Battleship</h2>
    

    @{ 
        if(Model.State === 3) {
            <div>
                <h3>Game Over! @Model.ActivePlayer.Name Won!</h3>
                <p style="text-align: center">
                    <a onclick="renderByName('StartMenu')">Try Again</a>
                </p>
            </div>
        } else {
            <h3>@Model.ActivePlayer.Name turn</h3>
        }
    }
    


    <form method="post">
        <div class="container">
            <div class="row">
                <div id="board" class="col capsizedText PressStart2PFont" style="font-size: 16px; line-height: 16px; padding: 0;">
                    @{
                        let ColorIntToCssString =
                        {
                            { 0, "rgb(12,     12,     12 )" },            // Black
                            { 1, "rgb(0,      55,     218)" },            // DarkBlue
                            { 2, "rgb(19,     161,    14 )" },            // DarkGreen
                            { 3, "rgb(58,     150,    221)" },            // DarkCyan
                            { 4, "rgb(197,    15,     31 )" },            // DarkRed
                            { 5, "rgb(136,    23,     152)" },            // DarkMagenta
                            { 6, "rgb(193,    156,    0  )" },            // DarkYellow
                            { 7, "rgb(204,    204,    204)" },            // Gray
                            { 8, "rgb(118,    118,    118)" },            // DarkGrey
                            { 9, "rgb(59,     120,    255)" },            // Blue
                            { 10, "rgb(22,    192,    12 )" },            // Green
                            { 11, "rgb(97,    214,    214)" },            // Cyan
                            { 12, "rgb(231,   72,     86 )" },            // Red
                            { 13, "rgb(180,   0,      158)" },            // Magenta
                            { 14, "rgb(249,   241,    165)" },            // Yellow
                            { 15, "rgb(242,   242,    242)" },            // White
                        };
                    
                        for (int y = 0; y < Model.gameBoard.lenght; y++)
                        {
                            <p style="display: flex; margin-top: 0; margin-bottom: 0;">
                                @for (int x = 0; x < Model.gameBoard[0].lenght; x++)
                                {
                                    let charInfo = Model.GameBoard[y][x];
                                    let colCss = ColorIntToCssString[charInfo.Color];
                                    let character = charInfo.Glyph;
                                    character = character === " " ? "." : character;
                                    <em style="color: @colCss;">@character</em>
                                }
                            </p>
                        }
                    }
                </div>
                <div class="col-md-auto container">
                    <div style="display: none; position: fixed">
                        <input type="radio" id="UP" name="KeyPress" value="UP" />
                        <input type="radio" id="DOWN" name="KeyPress" value="DOWN" />
                        <input type="radio" id="LEFT" name="KeyPress" value="LEFT" />
                        <input type="radio" id="RIGHT" name="KeyPress" value="RIGHT" />

                        <input type="radio" id="Z" name="KeyPress" value="Z" />
                        <input type="radio" id="X" name="KeyPress" value="X" />

                        <input type="radio" id="d1" name="KeyPress" value="d1" />
                        <input type="radio" id="d2" name="KeyPress" value="d2" />
                        <input type="radio" id="d3" name="KeyPress" value="d3" />

                        <input type="radio" id="takeBack" name="KeyPress" value="takeBack" />
                    </div>


                    <div class="row">
                        <div class="col"></div>
                        <div class="col">
                            <input type="submit" style="width: 100%;" onclick="checkRadioWithId('UP')" value="W" />
                        </div>
                        <div class="col"></div>
                    </div>
                    <div class="row">
                        <div class="col">
                            <input type="submit" style="width: 100%;" onclick="checkRadioWithId('LEFT')" value="A" />
                        </div>
                        <div class="col">
                            <input type="submit" style="width: 100%;" onclick="checkRadioWithId('DOWN')" value="S" />
                        </div>
                        <div class="col">
                            <input type="submit" style="width: 100%;" onclick="checkRadioWithId('RIGHT')" value="D" />
                        </div>
                    </div>
                    <br />

                </div>
            </div>
        </div>
        <br />
        <br />

    </form>


</body>
</html>
<script>

    main();

    function main() {
        let gameBoard = document.getElementById("gameBoard");
        /*
        let template = document.createElement('template');
        for (let y = 0; y < gameBoard.length; y++) {
            let p = document.createElement('p');
            for (let x = 0; x < gameBoard[0].length; x++) {
                let colCss = ColorIntToCssString[charInfo.GetColor()];
                let character = charInfo.GetGlyphString();
                character = character === " " ? "." : character;
                // let em = htmlToElement("<em style='color: @colCss;'>@character</em>");
                
                let em = document.createElement('em');
                em.style.color = colCss;
                em.innerText = character;
                p.appendChild(em);
            }
            template.appendChild(p);
        }
        
         */
    }

    /**
 * @param {String} html representing a single element
 * @return {ChildNode}
 */
    function htmlToElement(html) {
        let template = document.createElement('template');
        html = html.trim(); // Never return a text node of whitespace as the result
        template.innerHTML = html;
        return template.content.firstChild;
    }

function checkRadioWithId(id) {
  document.getElementById(id).checked = true;
}

function checkCheckboxWithId(id) {
  document.getElementById(id).checked = true;
}

function displayToggle(id) {
  let x = document.getElementById(id);
  if (x.style.display === "none") {
    x.style.display = "block";
  }
}
</script>